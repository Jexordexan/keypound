!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.keypound=t()}(this,function(){"use strict";function e(e){return u[e]||e.toUpperCase().charCodeAt(0)}function t(e){var t=e.replace(/\s/g,"").split(","),n=t.length-1;return""===t[n]&&(t[n-1]+=",",t=t.slice(0,-1)),t}function n(e){var t={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1};return e.slice(0,-1).forEach(function(e){var n=a[e],i=o[n];t[i]=!0}),t}function i(t){var i=[];return t=t.split("+"),i=n(t),t.length>1&&(t=[t[t.length-1]]),t=t[0],t=e(t),{key:t,mods:i}}function r(e,t){return s.every(function(n){return e[n]===t[n]})}for(var a={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},o={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"},s=Object.keys(o).map(function(e){return o[e]}),u={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},c=1;c<20;c++)u["f"+c]=111+c;var l=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),h=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};l(this,e),this.name=t,this._filter=i.filter,this._block=i.block||!1,this._paused=!1,this._master=n,this._bindings={}}return f(e,[{key:"__dispatch",value:function(e){var t=this;if(this._paused)return!1;var n=e.keyCode,i=!1;return n in this._bindings?(this._bindings[n].filter(function(t){return r(t.mods,e)}).forEach(function(n){("function"!=typeof t._filter||t._filter(e))&&(n.options&&n.options.prevent&&e.preventDefault(),n.handler(e,n),i=!0)}),i):this._block}},{key:"on",value:function(e,n,r){var a=this;t(e).forEach(function(t){t in a._master.aliases&&(t=a._master.aliases[t]);var o=i(t),s=o.mods;t=o.key,t in a._bindings||(a._bindings[t]=[]),a._bindings[t].push({key:t,handler:n,mods:s,options:r,shortcut:e})})}},{key:"off",value:function(e,n){var r=this;t(e).forEach(function(e){var t=i(e);if(t.key in r._bindings){var a=r._bindings[t.key];if(void 0!==n){var o=a.findIndex(function(e){return e.handler===n});o>-1&&a.splice(o,1)}else delete r._bindings[t.key]}})}},{key:"exit",value:function(){this._master.exit(this.name)}},{key:"pause",value:function(){this._paused=!0}},{key:"play",value:function(){this._paused=!1}}]),e}();return function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,e),this.stack=[],this.aliases={},this.keyEvent=n.keyEvent||"keydown",this.filter=n.defaultFilter||function(e){return"INPUT"!==e.target.nodeName&&"TEXTAREA"!==e.target.nodeName},this.__globalHandler=function(e){return t.onKeyPress(e)},document.addEventListener(this.keyEvent,this.__globalHandler),(n.createRoot||void 0===n.createRoot)&&this.enter("root")}return f(e,[{key:"createAlias",value:function(e,t){if(e in u||e in a)throw new Error("Bad alias: '"+e+"' is reserved");this.aliases[e]=t}},{key:"enter",value:function(e,t){var n=this.getStackIndex(e);return n>-1?this.moveToTop(n):this.enterNewContext(e,t)}},{key:"exit",value:function(e){var t=this.getStackIndex(e);return t>-1?this.stack.splice(t,1):null}},{key:"onKeyPress",value:function(e){for(var t=this.stack.length,n=!1;!n&&t--;)n=this.stack[t].__dispatch(e)}},{key:"moveToTop",value:function(e){var t=this.stack.splice(e,1),n=h(t,1),i=n[0];return this.stack.push(i),i}},{key:"enterNewContext",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.filter=t.filter||this.filter;var n=new d(e,this,t);return this.stack.push(n),n}},{key:"getStackIndex",value:function(e){return this.stack.findIndex(function(t){return t.name===e})}},{key:"destroy",value:function(){document.removeEventListener(this.keyEvent,this.__globalHandler)}}]),e}()});
//# sourceMappingURL=dist/keypound.min.js.map